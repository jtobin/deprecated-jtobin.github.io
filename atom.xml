<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[jtobin.ca]]></title>
  <link href="http://jtobin.github.io/atom.xml" rel="self"/>
  <link href="http://jtobin.github.io/"/>
  <updated>2014-01-22T13:41:51+08:00</updated>
  <id>http://jtobin.github.io/</id>
  <author>
    <name><![CDATA[Jared Tobin]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[Measures and Continuations]]></title>
    <link href="http://jtobin.github.io/blog/2014/01/08/measures-and-continuations/"/>
    <updated>2014-01-08T11:32:05+08:00</updated>
    <id>http://jtobin.github.io/blog/2014/01/08/measures-and-continuations</id>
    <content type="html"><![CDATA[<p>I’ve always been interested in measure theory.  I’m not even sure why, exactly.
Probably because it initially seemed so mysterious to me.  As an undergrad,
measure theory was this unknown, exotic key to <em>truly</em> understanding
probability.</p>

<p>Well, sort of.  It’s certainly the key to understanding formal probability,
but it no longer seems all that exotic, nor really necessary for grokking what
I’d call the true essence of probability.  It’s pretty much real analysis with
specialized attention paid to notions of factoring (independence) and ratios
(conditioning).  Nowadays I relate it moreso to accounting; not the most
inspiring of subjects, but necessary if you want to make sure everything adds
up the way you think it should.</p>

<!-- more -->

<p>Measures are just one of many structures that uniquely characterize probability
distributions, such as density functions, Fourier transforms, sampling
functions, and so on.  They’ve been considered to be particularly useful for
proving things, due to their generality.  They can be pretty abstract, but a
perfectly suitable analogy of a measure for most practical purposes is a
function that, when provided with a region, returns a volume.  Pretty simple.</p>

<p>Volume also tends to be synonymous with integration, in that given a (positive)
function, the integral of that function over some region defines a volume, or
‘area under the curve’.  For more general functions, integrals can be thought
of as returning a kind of center of mass.</p>

<p>Integration and measures go hand in hand.  In abstract integration, one
integrates a function over some region ‘against’ a measure, which assigns
particular weights to infinitesimals of the underlying space.  Measures that
tend to pop up in practice tend to be counting measure, Lebesgue measure, and
assorted image measures corresponding to particular probability distributions.</p>

<p>Imagine representing a measure on a computer.  One possible way to do it is to
represent a measure as an integral directly.  Or, rather, as a generic
<em>procedure</em> for integration.</p>

<p>Consider the setup where you pass a measurable function to an integration
procedure and it spits out a center of mass.  This has the convenient benefit
that the responsibility for preserving measurability can be delegated to the
function passed as an argument, rather than hard-coded into a measure itself
(which might be very hard to do).  Implemented in a type system - take
Haskell’s - we can implement a measure as something like</p>

<pre><code>newtype Measure a = Measure { measure :: (a -&gt; Double) -&gt; Double }
</code></pre>

<p>which is a wrapper over a measurable function that we want to integrate.</p>

<p>This is a restricted form of the <code>Cont</code> type used to define the continuation
monad.  That makes sense; we’re defining a measure to be a program that should
perform integration, and the particular implementation of that program defines
a particular measure.  If we’re willing to play things kind of fast and loose,
we can define measures by continuations proper:</p>

<pre><code>newtype Cont r a = Cont { runCont :: (a -&gt; r) -&gt; r }

instance Functor (Cont r) where
  fmap f c = Cont $ \g -&gt; runCont c (g . f)

instance Monad (Cont r) where
  return x = Cont $ \f -&gt; f x
  c &gt;&gt;= f  = Cont $ \d -&gt; runCont c $ \g -&gt; runCont (f g) d

type Measure a = Cont Double a
</code></pre>

<p>There are three immediately interesting things about this setup:</p>

<ul>
  <li><code>fmap</code> creates an image or pushforward measure by pushing a function onto an
existing measure</li>
  <li><code>return</code> is the Dirac measure at a point</li>
  <li><code>&gt;&gt;=</code> is a marginalizing operator</li>
</ul>

<p>There’s a big caveat in going this route: nonlinear continuation-y stuff like
<code>callCC</code> will break everything, so you can’t use it in the context of measures.
In practice defining a specific restricted type might be a bit safer, but we
can just avoid using it.</p>

<p>Usually we have something like $ \int f d\mathbb{P}$ in mathematical notation
to denote the integral of a function $ f $ against a measure $\mathbb{P}$, so
a more familiar version of <code>runCont</code> is</p>

<pre><code>integrate :: (a -&gt; Double) -&gt; Measure a -&gt; Double
integrate = flip runCont
</code></pre>

<p><code>integrate</code> defines the most basic ‘query’ of sorts on a measure.  You can
query a measure to find its volume, center of mass, and various higher-ordere
moments.  The simplest examples include:</p>

<pre><code>volume :: Measure a -&gt; Double
volume = integrate (const 1)

expectation :: Measure a -&gt; Double
expectation = integrate id

variance :: Measure a -&gt; Double
variance mu = integrate (^ 2) mu - expectation mu ^ 2
</code></pre>

<p>For any probability measure, <code>volume</code> should trivially return 1.</p>

<p>To create measures, you can put together functions like</p>

<pre><code>fromDensityCounting :: (a -&gt; Double) -&gt; [a] -&gt; Measure a
fromDensityLebesgue :: (Double -&gt; Double) -&gt; Measure Double
fromObservations    :: [a] -&gt; Measure a
</code></pre>

<p>that will create measures from the appropriate underlying structures. 
<code>fromObservations</code> is probably the most interesting, being the least
restrictive of the three.  You could also implement <code>fromSamplingFunction</code> to
create a (random) measure from a sampling function and a seed.</p>

<p>It’s easy to define stuff like abstract addition, subtraction, and
multiplication on measures.  Just use <code>liftM2</code> and your arithmetic operator of
choice.  In particular, abstract addition of measures corresponds to
measure convolution.</p>

<p>Viewing measures in this way is kind of neat, if of questionable practical
value.  You can see a implementation of this stuff
<a href="http://github.com/jtobin/measurable">here</a>, which includes a few examples to
boot.  But in practice, you can’t seem to get very far with an implementation
like this.  Exact computation involving probabilities is always going to be
limited to toy cases.  One of the key morals of <a href="http://web.mit.edu/vkm/www/vkm-dissertation.pdf">Vikash Mansinghka’s excellent
dissertation</a>, relevant here,
is “don’t compute probabilities; instead, sample good guesses”.  </p>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Basic EC2 Management with Ansible]]></title>
    <link href="http://jtobin.github.io/blog/2013/12/21/basic-ec2-management-with-ansible/"/>
    <updated>2013-12-21T12:26:56+08:00</updated>
    <id>http://jtobin.github.io/blog/2013/12/21/basic-ec2-management-with-ansible</id>
    <content type="html"><![CDATA[<p>EC2 is cool.  The ability to dynamically spin up a whack of free-to-cheap
server instances anywhere in the world at any time, is.. well, pretty mean.
Need to run a long computation job?  Scale up a distributed system?  Reduce
latency to clients in a particular geographical region?  YEAH WE CAN DO THAT.</p>

<p>The EC2 Management Console is a pretty great tool in of itself.  Well laid-out
and very responsive.  But for a hacker’s hacker, a great tool to manage EC2
instances (amongst other things) is Ansible, which provides a way to automate
tasks over an arbitrary number of servers, concurrently.</p>

<p>With EC2 and Ansible you can rapidly find yourself controlling an amorphous,
globally-distributed network of servers that are eager to do your bidding.</p>

<p><img src="http://i.imgur.com/EE2uqkU.jpg" /></p>

<p>Again.. pretty mean. </p>

<!-- more -->

<p>Here’s a quick example that elides most of the nitty-gritty details.  I’m going
to spin up three micro instances in Asia Pacific.  To do that, I’m going to use
an Ansible playbook, which is essentially a YAML file that describes a sequence
of commands to be performed.  I’m going to delegate my local machine to handle
that task, so I’m first going to store the following inventory in
/etc/ansible/local:</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
</pre></td><td class="code"><pre><code class="yaml"><span class="line"><span class="p-Indicator">[</span><span class="nv">localhost</span><span class="p-Indicator">]</span>
</span><span class="line"><span class="l-Scalar-Plain">127.0.0.1</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>The following playbook is what actually launches these guys.  Here’s its
header:</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span>spin-up-instances.yml</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
<span class="line-number">10</span>
<span class="line-number">11</span>
<span class="line-number">12</span>
<span class="line-number">13</span>
<span class="line-number">14</span>
<span class="line-number">15</span>
<span class="line-number">16</span>
<span class="line-number">17</span>
<span class="line-number">18</span>
<span class="line-number">19</span>
<span class="line-number">20</span>
<span class="line-number">21</span>
<span class="line-number">22</span>
<span class="line-number">23</span>
<span class="line-number">24</span>
<span class="line-number">25</span>
<span class="line-number">26</span>
<span class="line-number">27</span>
<span class="line-number">28</span>
<span class="line-number">29</span>
<span class="line-number">30</span>
<span class="line-number">31</span>
<span class="line-number">32</span>
<span class="line-number">33</span>
<span class="line-number">34</span>
<span class="line-number">35</span>
<span class="line-number">36</span>
<span class="line-number">37</span>
<span class="line-number">38</span>
<span class="line-number">39</span>
<span class="line-number">40</span>
<span class="line-number">41</span>
<span class="line-number">42</span>
</pre></td><td class="code"><pre><code class="yaml"><span class="line"><span class="nn">---</span>
</span><span class="line"><span class="p-Indicator">-</span> <span class="l-Scalar-Plain">name</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">Spin up some EC2 instances</span>
</span><span class="line">  <span class="l-Scalar-Plain">hosts</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">127.0.0.1</span>
</span><span class="line">  <span class="l-Scalar-Plain">connection</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">local</span>
</span><span class="line">  <span class="l-Scalar-Plain">tasks</span><span class="p-Indicator">:</span>
</span><span class="line">    <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">name</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">Create security group</span>
</span><span class="line">      <span class="l-Scalar-Plain">local_action</span><span class="p-Indicator">:</span>
</span><span class="line">        <span class="l-Scalar-Plain">module</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">ec2_group</span>
</span><span class="line">        <span class="l-Scalar-Plain">name</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">my-security-group</span>
</span><span class="line">        <span class="l-Scalar-Plain">description</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">Access my-security-group</span>
</span><span class="line">        <span class="l-Scalar-Plain">region</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">ap-southeast-2</span>
</span><span class="line">        <span class="l-Scalar-Plain">rules</span><span class="p-Indicator">:</span>
</span><span class="line">          <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">proto</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">tcp</span>
</span><span class="line">            <span class="l-Scalar-Plain">from_port</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">22</span>
</span><span class="line">            <span class="l-Scalar-Plain">to_port</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">22</span>
</span><span class="line">            <span class="l-Scalar-Plain">cidr_ip</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">0.0.0.0/0</span>
</span><span class="line">
</span><span class="line">    <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">name</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">Launch instances</span>
</span><span class="line">      <span class="l-Scalar-Plain">local_action</span><span class="p-Indicator">:</span>
</span><span class="line">        <span class="l-Scalar-Plain">module</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">ec2</span>
</span><span class="line">        <span class="l-Scalar-Plain">region</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">ap-southeast-2</span>
</span><span class="line">        <span class="l-Scalar-Plain">keypair</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">jtobin-aws</span>
</span><span class="line">        <span class="l-Scalar-Plain">group</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">my-security-group</span>
</span><span class="line">        <span class="l-Scalar-Plain">instance_type</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">t1.micro</span>
</span><span class="line">        <span class="l-Scalar-Plain">image</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">ami-3d128f07</span>
</span><span class="line">        <span class="l-Scalar-Plain">count</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">3</span>
</span><span class="line">        <span class="l-Scalar-Plain">wait</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">yes</span>
</span><span class="line">      <span class="l-Scalar-Plain">register</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">ec2</span>
</span><span class="line">
</span><span class="line">    <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">name</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">Add instances to host group</span>
</span><span class="line">      <span class="l-Scalar-Plain">local_action</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">add_host hostname= groupname=my-security-group</span>
</span><span class="line">      <span class="l-Scalar-Plain">with_items</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">ec2.instances</span>
</span><span class="line">
</span><span class="line">    <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">name</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">Tag instances</span>
</span><span class="line">      <span class="l-Scalar-Plain">local_action</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">ec2_tag resource= region=ap-southeast-2 state=present</span>
</span><span class="line">      <span class="l-Scalar-Plain">with_items</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">ec2.instances</span>
</span><span class="line">      <span class="l-Scalar-Plain">args</span><span class="p-Indicator">:</span>
</span><span class="line">        <span class="l-Scalar-Plain">tags</span><span class="p-Indicator">:</span>
</span><span class="line">          <span class="l-Scalar-Plain">Name</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">Abrek</span>
</span><span class="line">
</span><span class="line">    <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">name</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">Give everyone a minute</span>
</span><span class="line">      <span class="l-Scalar-Plain">pause</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">minutes=1</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>Roughly, the tasks I want performed are each declared with a name and follow
the ‘tasks:’ line.  They’re relatively self-explanatory.  When Ansible runs
this playbook, it will execute the tasks in the order they appear in the
playbook.</p>

<p>First I create a security group in Asia Pacific (Sydney) for all the instances
I want to launch, and then go ahead and actually launch the instances.  You can
see that I launch them as a local action on my machine.  I’m using micro
instances (the most lightweight instance type available) and pick an Ubuntu LTS
Server machine image for each.  I then do some bookkeeping and tag each
instance with the name ‘Abrek’.  The final task just pauses the playbook
execution long enough for the instances to get up and running.</p>

<p>Fun fact: ‘Abrek’ was the name of one of the first two Soviet monkeys shot into
space.  Today is apparently the 30th anniversary of his safe return.</p>

<p>Now, I also want to install some software on each of these guys.  I’ll separate
all that into two groups: some essentials, and a specialized stack consisting
of 0MQ and supporting libraries.  To do that, I’ll create two separate files
called ‘install-essentials.yml’ and ‘install-specialized.yml’.</p>

<p>I’ll keep the essentials bare for now: git, gcc/g++, and make.</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span>install-essentials.yml</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
<span class="line-number">10</span>
<span class="line-number">11</span>
<span class="line-number">12</span>
</pre></td><td class="code"><pre><code class="yaml"><span class="line"><span class="nn">---</span>
</span><span class="line"><span class="p-Indicator">-</span> <span class="l-Scalar-Plain">name</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">Install git</span>
</span><span class="line">  <span class="l-Scalar-Plain">apt</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">pkg=git update_cache=yes</span>
</span><span class="line">
</span><span class="line"><span class="p-Indicator">-</span> <span class="l-Scalar-Plain">name</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">Install gcc</span>
</span><span class="line">  <span class="l-Scalar-Plain">apt</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">pkg=gcc</span>
</span><span class="line">
</span><span class="line"><span class="p-Indicator">-</span> <span class="l-Scalar-Plain">name</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">Install g++</span>
</span><span class="line">  <span class="l-Scalar-Plain">apt</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">pkg=g++</span>
</span><span class="line">
</span><span class="line"><span class="p-Indicator">-</span> <span class="l-Scalar-Plain">name</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">Install make</span>
</span><span class="line">  <span class="l-Scalar-Plain">apt</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">pkg=make</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>I can grab all of those via apt.  ‘update_cache’ is equivalent to ‘apt-get
update’, which only needs to be done once.</p>

<p>Next, the specialized stuff:</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span>install-specialized.yml</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
<span class="line-number">10</span>
<span class="line-number">11</span>
<span class="line-number">12</span>
<span class="line-number">13</span>
<span class="line-number">14</span>
<span class="line-number">15</span>
<span class="line-number">16</span>
<span class="line-number">17</span>
<span class="line-number">18</span>
<span class="line-number">19</span>
<span class="line-number">20</span>
<span class="line-number">21</span>
<span class="line-number">22</span>
<span class="line-number">23</span>
<span class="line-number">24</span>
<span class="line-number">25</span>
<span class="line-number">26</span>
<span class="line-number">27</span>
<span class="line-number">28</span>
<span class="line-number">29</span>
<span class="line-number">30</span>
<span class="line-number">31</span>
<span class="line-number">32</span>
<span class="line-number">33</span>
<span class="line-number">34</span>
<span class="line-number">35</span>
<span class="line-number">36</span>
<span class="line-number">37</span>
<span class="line-number">38</span>
<span class="line-number">39</span>
<span class="line-number">40</span>
<span class="line-number">41</span>
<span class="line-number">42</span>
<span class="line-number">43</span>
<span class="line-number">44</span>
<span class="line-number">45</span>
<span class="line-number">46</span>
<span class="line-number">47</span>
<span class="line-number">48</span>
<span class="line-number">49</span>
<span class="line-number">50</span>
<span class="line-number">51</span>
<span class="line-number">52</span>
<span class="line-number">53</span>
<span class="line-number">54</span>
<span class="line-number">55</span>
<span class="line-number">56</span>
</pre></td><td class="code"><pre><code class="yaml"><span class="line"><span class="nn">---</span>
</span><span class="line"><span class="p-Indicator">-</span> <span class="l-Scalar-Plain">name</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">Grab 0MQ</span>
</span><span class="line">  <span class="l-Scalar-Plain">command</span><span class="p-Indicator">:</span> <span class="p-Indicator">&gt;</span>
</span><span class="line">    <span class="no">wget http://download.zeromq.org/zeromq-4.0.3.tar.gz</span>
</span><span class="line">    <span class="no">creates=zeromq-4.0.3.tar.gz</span>
</span><span class="line">
</span><span class="line"><span class="p-Indicator">-</span> <span class="l-Scalar-Plain">name</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">Unpack 0MQ</span>
</span><span class="line">  <span class="l-Scalar-Plain">command</span><span class="p-Indicator">:</span> <span class="p-Indicator">&gt;</span>
</span><span class="line">    <span class="no">tar -xzf zeromq-4.0.3.tar.gz</span>
</span><span class="line">    <span class="no">creates=zeromq-4.0.3</span>
</span><span class="line">
</span><span class="line"><span class="p-Indicator">-</span> <span class="l-Scalar-Plain">name</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">Get libsodium</span>
</span><span class="line">  <span class="l-Scalar-Plain">command</span><span class="p-Indicator">:</span> <span class="p-Indicator">&gt;</span>
</span><span class="line">    <span class="no">wget https://download.libsodium.org/libsodium/releases/libsodium-0.4.5.tar.gz</span>
</span><span class="line">    <span class="no">creates=libsodium-0.4.5</span>
</span><span class="line">    <span class="no">chdir=zeromq-4.0.3</span>
</span><span class="line">
</span><span class="line"><span class="p-Indicator">-</span> <span class="l-Scalar-Plain">name</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">Install libsodium</span>
</span><span class="line">  <span class="l-Scalar-Plain">shell</span><span class="p-Indicator">:</span> <span class="p-Indicator">&gt;</span>
</span><span class="line">    <span class="no">tar xzf libsodium-0.4.5.tar.gz;</span>
</span><span class="line">    <span class="no">cd libsodium-0.4.5;</span>
</span><span class="line">    <span class="no">./configure &amp;&amp; make &amp;&amp; make check &amp;&amp; make install</span>
</span><span class="line">    <span class="no">chdir=zeromq-4.0.3</span>
</span><span class="line">
</span><span class="line"><span class="p-Indicator">-</span> <span class="l-Scalar-Plain">name</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">Install 0MQ</span>
</span><span class="line">  <span class="l-Scalar-Plain">shell</span><span class="p-Indicator">:</span> <span class="p-Indicator">&gt;</span>
</span><span class="line">    <span class="no">./configure; make; make install</span>
</span><span class="line">    <span class="no">chdir=zeromq-4.0.3</span>
</span><span class="line">
</span><span class="line"><span class="p-Indicator">-</span> <span class="l-Scalar-Plain">name</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">Install libtool</span>
</span><span class="line">  <span class="l-Scalar-Plain">apt</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">pkg=libtool</span>
</span><span class="line">
</span><span class="line"><span class="p-Indicator">-</span> <span class="l-Scalar-Plain">name</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">Install automake</span>
</span><span class="line">  <span class="l-Scalar-Plain">apt</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">pkg=automake</span>
</span><span class="line">
</span><span class="line"><span class="p-Indicator">-</span> <span class="l-Scalar-Plain">name</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">Install automake</span>
</span><span class="line">  <span class="l-Scalar-Plain">apt</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">pkg=autoconf</span>
</span><span class="line">
</span><span class="line"><span class="p-Indicator">-</span> <span class="l-Scalar-Plain">name</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">Install uuid-dev</span>
</span><span class="line">  <span class="l-Scalar-Plain">apt</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">pkg=uuid-dev</span>
</span><span class="line">
</span><span class="line"><span class="p-Indicator">-</span> <span class="l-Scalar-Plain">name</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">Grab CZMQ</span>
</span><span class="line">  <span class="l-Scalar-Plain">command</span><span class="p-Indicator">:</span> <span class="p-Indicator">&gt;</span>
</span><span class="line">    <span class="no">wget http://download.zeromq.org/czmq-2.0.3.tar.gz</span>
</span><span class="line">    <span class="no">creates=czmq-2.0.3.tar.gz</span>
</span><span class="line">
</span><span class="line"><span class="p-Indicator">-</span> <span class="l-Scalar-Plain">name</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">Unpack CZMQ</span>
</span><span class="line">  <span class="l-Scalar-Plain">command</span><span class="p-Indicator">:</span> <span class="p-Indicator">&gt;</span>
</span><span class="line">    <span class="no">tar xzf czmq-2.0.3.tar.gz</span>
</span><span class="line">    <span class="no">creates=czmq-2.0.3</span>
</span><span class="line">
</span><span class="line"><span class="p-Indicator">-</span> <span class="l-Scalar-Plain">name</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">Install CZMQ</span>
</span><span class="line">  <span class="l-Scalar-Plain">shell</span><span class="p-Indicator">:</span> <span class="p-Indicator">&gt;</span>
</span><span class="line">    <span class="no">./configure &amp;&amp; make;</span>
</span><span class="line">    <span class="no">ldconfig</span>
</span><span class="line">    <span class="no">chdir=czmq-2.0.3</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>Lots going on here.  I use a variety of apt and shell commands to download and
install everything I need.</p>

<p>Now to add those tasks back into the ‘spin-up-instances.yml’ playbook so that
the software gets installed right after the instances boot up.  I can append
the following to that file:</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span>spin-up-instances.yml</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
</pre></td><td class="code"><pre><code class="yaml"><span class="line"><span class="p-Indicator">-</span> <span class="l-Scalar-Plain">name</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">Install essential and specialized software</span>
</span><span class="line">  <span class="l-Scalar-Plain">hosts</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">my-security-group</span>
</span><span class="line">  <span class="l-Scalar-Plain">user</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">ubuntu</span>
</span><span class="line">  <span class="l-Scalar-Plain">sudo</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">True</span>
</span><span class="line">  <span class="l-Scalar-Plain">tasks</span><span class="p-Indicator">:</span>
</span><span class="line">    <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">include</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">tasks/install-essentials.yml</span>
</span><span class="line">    <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">include</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">tasks/install-specialized.yml</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>Let’s run the playbook and see those instances get launched.  I need to use the
‘local’ inventory that I set up, so I pass that to ‘ansible-playbook’
explicitly.</p>

<p>Running it, we can see the security group being created, the instances popping
up, and tags getting assigned:</p>

<p><img src="http://jtobin.github.io/images/ansible-first.png" /></p>

<p>Our essential software getting pulled down:</p>

<p><img src="http://jtobin.github.io/images/ansible-third.png" /></p>

<p>And the tail end of our 0MQ stack showing up before the play ends with a
summary.</p>

<p><img src="http://jtobin.github.io/images/ansible-fourth.png" /></p>

<p>For a quick sanity check to ensure that everything really did go as planned, I
can look for the CZMQ header on each instance.  This time I’ll run a quick
ad-hoc command, identifying the hosts via the ‘Abrek’ tag:</p>

<p><img src="http://jtobin.github.io/images/ansible-fifth.png" /></p>

<p>Voila, three servers ready to roll.  Great stuff.</p>

<p>To fill the missing details, you might want to check out the excellent <a href="http://www.ansibleworks.com/docs/">Ansible
documentation</a>, as well as the great
tutorials at <a href="http://http://answersforaws.com/">AnswersForAws</a>.</p>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Managing Learning as a Side Project]]></title>
    <link href="http://jtobin.github.io/blog/2013/12/20/side-projects/"/>
    <updated>2013-12-20T10:12:02+08:00</updated>
    <id>http://jtobin.github.io/blog/2013/12/20/side-projects</id>
    <content type="html"><![CDATA[<p>I regularly find myself wanting to learn too many things at once.  This might
be justifiable in some sense; there’s an awful lot out there to learn.  Often,
skimming over some topic or other feels like enough to develop a sufficiently
high-level model of what it is or how it works.  Armed with that (dangerously
small amount of) knowledge, however, the urge to pick up some other topic tends
to arise..  and so the process repeats.</p>

<p>This is all well and good in order to survey what’s out there, but left
unchecked, a survey of topics is all one might get.  <em>Le dilettantisme</em> can be
understandable, but never desirable.</p>

<p>Some time ago, I decided to try restricting myself to learning only one
particular topic for two weeks at a time, as a bit of a side project.  Think of
it as a ‘learning sprint’, if you will.  The idea is that the time between
iterations is sufficiently short to ensure that one can’t hunger too badly to
switch to some other topic mid-sprint.  At the same time, each iteration is
lengthy enough to ensure a reasonable amount of immersion and depth.</p>

<p>I managed a single iteration, but due to travel and a lack of conviction about
the whole thing, never started another.  I think I’m going to start again, but
with a little more intent this time.</p>

<p>Two weeks can be a long-as time for some topics, though, so I believe I’ll work
in one-to-two week commitments, depending on the subject.</p>

<p>To start, I’m going to choose <a href="http://zeromq.org/">0MQ</a>, a framework that I
sort-of know and definitely love.  We’ve used it in production on a previous
app I worked on, and I’ve even contributed to the official Ruby bindings.  But,
I still have a lot to learn about it.</p>

<p>So let’s see how it goes.</p>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[A new blog]]></title>
    <link href="http://jtobin.github.io/blog/2013/12/17/a-new-blog/"/>
    <updated>2013-12-17T05:46:26+08:00</updated>
    <id>http://jtobin.github.io/blog/2013/12/17/a-new-blog</id>
    <content type="html"><![CDATA[<p>I’ve been feeling an itch to write more often, and this seems as good a place
as any to do it.  If anything here winds up being useful to anyone else, all
the better.</p>

]]></content>
  </entry>
  
</feed>
